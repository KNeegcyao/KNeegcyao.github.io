---
title: '网络编程懒人入门(十一):一文读懂什么是IPv6'
tags:
  - 基础知识
categories:
  - 计算机网络
top_img: >-
  https://haowallpaper.com/link/common/file/previewFileImg/f351ca6264cb84d5053926824a04634af351ca6264cb84d5053926824a04634a
cover: >-
  https://ts1.cn.mm.bing.net/th/id/R-C.5a39c299f3ced2c10b1e76183339c73e?rik=y1GjYN9iv1utPw&riu=http%3a%2f%2fimg.aiimg.com%2fuploads%2fuserup%2f0909%2f1102045635U.jpg&ehk=FmHrFX4Y2W1j2BOzHgGIDqMdZZtwbi48iYjATaOCDko%3d&risl=&pid=ImgRaw&r=0
abbrlink: b505a401
date: 2024-12-03 14:25:10
---
## 引言

现在IPv6的技术应用已经越来越普及了，很多应用都开始支持IPv6。

![网络编程懒人入门(十一)：一文读懂什么是IPv6_a.jpg](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/132420kj8j25j51jly55by.jpg)

▲ 去年开始，支付宝的官网上就已出现“支持IPv6”标识

对于即时通讯技术（尤其是IM应用）的开发者来说，新产品上架苹果的App Store因IPv6问题被拒的情况，很常见。每次也都能根据网上的资料一一解决，并顺利通过审核。

然而几次下来，到底什么是IPv6，还是有点云里雾里。

那么，IP协议在TCP/IP体系中到底有多重要？看看下图便知（原因清晰版：[从此处进入下载](http://www.52im.net/thread-180-1-1.html)）。

![网络编程懒人入门(十一)：一文读懂什么是IPv6_b.png](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/134046fcromaau5nzh36ni.png)

▲ 红圈处就是IP协议，它几乎是整个TCP/IP协议簇的支撑（图引用自《[计算机网络通讯协议关系图](http://www.52im.net/thread-180-1-1.html)》）

总之，IP协议在TCP/IP体系中，是非常重要的一环（可以认为，没它，也就没有了互联网），作为IPv4的下一代协议，了解IPv6非常有必要。而作为即时通讯开发者来说，了解IPv6就显的尤为迫切，说不定某天你的IM就会因为IPv6问题而导致无法通信的局面出现。

本文将用浅显易懂的文字，带你了解到底什么是IPv6。

**推荐阅读1：**关于IPv6的更详细技术文章请见《[IPv6技术详解：基本概念、应用现状、技术实践（上篇）](http://www.52im.net/thread-1605-1-1.html)》、《[IPv6技术详解：基本概念、应用现状、技术实践（下篇）](http://www.52im.net/thread-1607-1-1.html)》。另一篇有关Java支持IPv6的文章也可以阅读：《[Java对IPv6的支持详解：支持情况、相关API、演示代码等](http://www.52im.net/thread-3236-1-1.html)》。

**推荐阅读2：**本文作者的另一篇同类文章《[网络编程入门从未如此简单(三)：什么是IPv6？漫画式图文，一篇即懂！](http://www.52im.net/thread-3868-1-1.html)》。

## 复习一下什么是IPv4？

IPv4是Internet Protocol version 4的缩写，中文翻译为互联网通信协议第四版，通常简称为网际协议版本4。

IPv4使用32位（4字节）地址，因此地址空间中只有 4,294,967,296（即2^32） 个地址。

IPv4地址可被写作任何表示一个32位整数值的形式，但为了方便人类阅读和分析，它通常被写作点分十进制的形式，即四个字节被分开用十进制写出，中间用点分隔。

**通常IPv4地址的地址格式为 nnn.nnn.nnn.nnn，就像下面这样：**

172.16.254.1

**下图看起来更清晰一些：**

![网络编程懒人入门(十一)：一文读懂什么是IPv6_x7.png](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/152806dod2ky676272di27.png)

## IPv6又是什么？

IPv6是Internet Protocol version 6的缩写，中文翻译为互联网通信协议（TCP/IP协议）第6版，通常简称为网际协议版6。IPv6具有比IPv4大得多的编码地址空间，用它来取代IPv4主要是为了解决IPv4地址枯竭问题，同时它也在其他方面对于IPv4有许多改进。

其实，IPv6并不是新技术，从IPv6最早的工作组成立1992年到现在，已过去27年。在互联网技术的发展历程中，IPv6年龄甚至有些太大了。

IPv6的“6”表示的是TCP/IP协议的第六个版本，IPv4的“4”表示的是TCP/IP协议的第四个版本。其实除了这两个版本，当然还有其它版本，TCP/IP协议其实从IPv1开始，到现在IPv10都已经出现了，这些不同版本之间并没有关联，也不是简单IP地址长度的长短。

IPv6地址由八组、每组四位16进制数字组成，每组之间由"："来分隔。

**看个简单的例子：**

2610:00f8:0c34:67f9:0200:83ff:fe94:4c36，每个“：”前后都是4位16进制的数字，共分隔成8组。

**如下图所示：**

![网络编程懒人入门(十一)：一文读懂什么是IPv6_x9.png](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/154331qsnajbxb9mrs6jbq.png)

**小知识：**如何查看手机或者电脑的网络是否支持IPv6呢？
可以在你手机或者电脑上的浏览器中打开：[Ipv6-test.com](http://www.52im.net/Ipv6-test.com)，就像下图这样：

![网络编程懒人入门(十一)：一文读懂什么是IPv6_x8.png](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/154939od2im72kv2ni2vnm.png)

## 为什么要使用IPv6？

最主要的原因，就是地址数量不够用了。

IPv4迄今为止已经使用了30多年。最早期的时候，互联网只是设计给美国军方用的，根本没有考虑到它会变得如此庞大，成为全球网络。

尤其是进入21世纪后，随着计算机和智能手机的迅速普及，互联网开始爆发性发展，越来越多的上网设备出现，越来越多的人开始连接互联网。这就意味着，需要越来越多的IP地址。

IPv4的地址总数是2的32次方，也就是约42.9亿个。而全球的网民总数早已超过这个数目。

![网络编程懒人入门(十一)：一文读懂什么是IPv6_x5.jpg](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/150537h81scgpswzmrjn7e.jpg)

所以说，IPv4地址池接近枯竭，根本无法满足互联网发展的需要。人们迫切需要更高版本的IP协议，更大数量的IP地址池。（有点像固定电话号码升位。）

## 6IPv6会带给我们什么？

首先，最重要的一点，就是前面所说的地址池扩容。IPv4的地址池是约42.9亿，IPv6能达到多少呢？

**数量如下：**

340282366920938463463374607431768211456个…

不用数了，太多了… 简单说，是2的128次方。

![网络编程懒人入门(十一)：一文读懂什么是IPv6_x1jpg.jpg](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/143126mvdp5r5e6lv3lrde.jpg)

这个数量，即使是给地球上每一颗沙子都分配一个IP，也是妥妥够用的。

![网络编程懒人入门(十一)：一文读懂什么是IPv6_x10.png](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/155118tzlenlbab3138kcb.png)

▲ 这图你看懂了吗？嗯，我也没看懂，反正就是很多的样子

这个数量值是怎么得来的呢？还是它的地址位长决定的。

如果以二进制来写，IPv6的地址是128位。不过，这样写显然不太方便（一行都写不下）。所以，通常用十六进制来写，也就缩短成32位（32位会分为8组，每组4位）。

![网络编程懒人入门(十一)：一文读懂什么是IPv6_x2.jpg](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/143313fu2lwggzzi7lputi.jpg)

**下面就是一个标准、合法的IPv6地址示例：**

2001:0db8:85a3:08d3:1319:8a2e:0370:7344

**注意：**IPv6的地址是可以简写的，每项数字前导的0可以省略。

**例如，下面这个地址：**
2001:0DB8:02de:0000:0000:0000:0000:0e13

**粉红的“0”就可以省略，变成：**

2001: DB8:2de:0:0:0:0:e13

**如果有一组或连续几组都是0，那么可以简写成“::”，也就是：**

2001: DB8:2de::e13

**注意：**一个IPv6地址，只能有一个“::”。

**为什么？很简单，你看下面这四个地址，如果所有0全都缩写，会变成什么样？**

2001:0000:0000:0000:0000:25de:0000:cade
2001: 0000: 0000:0000:25de:0000:0000:cade
2001: 0000: 0000:25de:0000:0000:0000:cade
2001: 0000: 25de:0000:0000:0000:0000:cade

是的，都是2001::25de::cade，冲突了。所以，这个地址是非法的，不允许存在的。

关于IPv6还有很多技术细节，因篇幅原因，不再赘述。

**除了地址数量之外，IPv6还有很多优点，例如：**

- 1）IPv6使用更小的路由表。使得路由器转发数据包的速度更快；
- 2）IPv6增加了增强的组播支持以及对流的控制，对多媒体应用很有利，对服务质量（QoS）控制也很有利；
- 3）IPv6加入了对自动配置的支持。这是对DHCP协议的改进和扩展，使得网络（尤其是局域网）的管理更加方便和快捷；
- 4）IPv6具有更高的安全性。用户可以对网络层的数据进行加密并对IP报文进行校验，极大地增强了网络的安全性；
- 5）IPv6具有更好的扩容能力。如果新的技术或应用需要时，IPV6允许协议进行扩充；
- 6）IPv6具有更好的头部格式。IPV6使用新的头部格式，就简化和加速了路由选择过程，提高了效率；
- ……

## IPv6的优点这么多，为什么之前普及却这么慢？

IPv6优点这么多，为什么它问世已经20年了，还是没有完全替代IPv4呢？这里面的水就很深了。。。说白了，主要还是和利益有关。

### NAT这类技术，让IPv4得以续命

如果按照本世纪初专家们的预测，我们IPv4的地址早已枯竭几万次了。但是，一直挺到现在，大家仍然还在用IPv4，对老百姓来说，并没有因为地址不够而无法上网。

这是为什么呢？ 就是因为除了IPv6之外，我们还有一些技术，可以变相地缓解地址不足。

例如NAT（Network Address Translation，网络地址转换）。

NAT是什么意思？当我们在家里或公司上网时，你的电脑肯定有一个类似192.168.0.1的地址，这种地址属于私网地址，不属于公共的互联网地址。

![网络编程懒人入门(十一)：一文读懂什么是IPv6_x3.jpg](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/145306l3zns5821l18juj3.jpg)

▲ 一个典型的NAT应用场景（图自《[IPv6，到底是什么？](https://blog.csdn.net/qq_38987057/article/details/81359401)》）

每一个小的局域网，都会使用一个网段的私网地址，在与外界连接时，再变换成公网地址。这样一来，几十个或几百个电脑，都只需要一个公网地址。

甚至还可以私网套私网，NAT套NAT，一层一层套。这样一来，大大节约了公网IP地址数量。正因为如此，才让我们“续命”到了今天，不至于无法上网。

但是，NAT这种方式也有很多缺点，虽然私网地址访问互联网地址方便，但互联网地址访问私网地址就困难了。很多服务，都会受到限制，你只能通过复杂的设置才能解决，也会影响网络的处理效率。

![网络编程懒人入门(十一)：一文读懂什么是IPv6_x4.jpg](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/145519qsez2meng7bsw2j7.jpg)

▲ NAT内网的计算机是不能被外网直接访问的（图自《[IPv6，到底是什么？](https://blog.csdn.net/qq_38987057/article/details/81359401)》）

### 升级IPv6涉及运营商的利益

物以稀为贵，地址越稀缺，就越值钱。掌握地址的人，就越开心。谁开心？运营商和ISP（互联网服务提供商）。

他们就像是经销商，从上游（互联网域名与号码分配机构，即ICANN）申请到IP地址，再卖给下游用户。稀缺没关系，反正，他一定能赚取更多的差价。

如果大家去找运营商或ISP买带宽，或者租赁云服务，带公共地址的，一定比不带公共地址的贵很多很多。

除了地址可以赚钱之外，如果升级支持IPv6，对运营商和ISP来说，也意味着很大的资金投入。现在新设备基本都是支持的，但毕竟还是有一些老设备，如果在使用寿命到期之前就换，就是亏钱。

所以，运营商和ISP都没有动力去启用IPv6。

![网络编程懒人入门(十一)：一文读懂什么是IPv6_x11.png](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/155908wo4olmulj2rcxv32.png)

至于设备商或手机电脑厂商，出于提前考虑，早已普遍支持了IPv6，意见并不是很大，也决定不了什么。必竟，提供基础设施服务的运营商们更强势。

## IPv6未来会怎样

随着5G时代的到来，有了IPv6的加持，万物互联或许会成为现实。对于我等实时通信类软件的开发人员来说，某些场景下，或许再也不需要为“P2P打洞”这种事情烦恼了。

![网络编程懒人入门(十一)：一文读懂什么是IPv6_x6.jpg](https://cdn.jsdelivr.net/gh/KNeegcyao/picdemo/img/152007eazi9zcttivsf76s.jpg)

▲ 5G+IPv6，万物互联不是梦

未来已来，你准备好了吗？
